using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using System;

public class NowAbility : MonoBehaviour
{
	// 現在のアイコンの画像
	[SerializeField]
	private Image i_IconSprite;

	[SerializeField]
	List<AbilityCheck>  lac_Ability = new List<AbilityCheck>();

	[SerializeField]
	List<Sprite>      ls_Ability = new List<Sprite>();

	[SerializeField]
	List<int>         ln_AbilityNumber = new List<int>();

	private int       n_NowSetAbility;
	private int       n_NextAbility;
	private const int cn_None = 12;

	// 能力発動する配列番号(双子座用)
	private int n_ArrayAbility;

	public void SharingAbility(int _ability) { n_NextAbility = _ability; }

	// 双子座用
	public int SharingGeminiAttackNum() { return n_ArrayAbility; }

	public int GetNowAbility() { return n_NowSetAbility; }
	public Sprite GetNowSprite() { return ls_Ability[n_NowSetAbility]; }

	// Start is called before the first frame update
	void Start()
    {
		n_NowSetAbility = cn_None;
		n_NextAbility = cn_None;
		n_ArrayAbility = cn_None;

		i_IconSprite = this.GetComponent<Image>();
		i_IconSprite.color = new Color(1.0f, 1.0f, 1.0f, 0.0f);
	}

    // Update is called once per frame
    void Update()
    {
		if (n_NextAbility == n_NowSetAbility) return;

		// 予期していない値が入らないように
		n_ArrayAbility = IsUseIcon(n_NextAbility);
		if (n_ArrayAbility == cn_None) return;

		// 今使える能力をステージに落とす
		int now_ability = IsUseIcon(n_NowSetAbility);
		if (now_ability != cn_None) lac_Ability[now_ability].AbilityRelease();

		n_NowSetAbility = n_NextAbility;
		i_IconSprite.sprite = ls_Ability[n_ArrayAbility];
		i_IconSprite.color = new Color(1.0f, 1.0f, 1.0f, 1.0f);
	}

	// 万が一、予期していない値が入った時用
	int IsUseIcon(int _check)
	{
		for(int i = 0;i < ls_Ability.Count; i++) {
			if (ln_AbilityNumber[i] == _check) return i;
		}
		return cn_None;
	}
}
